<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<script src="ProblemSolvingAgent.js"></script>
	<script src="Space.js"></script>
	<style>
		#svg-space {
			transform-origin: 50% 50%;
		}
	</style>
</head>
<body onload="startSpace()">
<svg id="svg-space" xmlns="http://www.w3.org/2000/svg"></svg>
<p>Drag and drop the red(initial State) and blue(Goal State) to change their positions</p>
<label for="weight">
	Set Weight for <pre>wA*</pre>
	<input type="text" id="weight" value="1">
</label>
<button onclick="start()">Start Search</button>
<script>

//MAIN ##########################
	var space;
	var initialAgent;
	var goalAgent;

	function startSpace() {

		space = new Space('http://www.w3.org/2000/svg');

		space.draw();

		space.bindClickEvent();

		initialAgent = new Agent('ini', new Point(0,0), '#FF002B');
		initialAgent.drawInSpace(space);
		initialAgent.bindDragNDrop(space);

		goalAgent = new Agent('goal', new Point(9,9), '#0000FF');
		goalAgent.drawInSpace(space);
		goalAgent.bindDragNDrop(space);

		return space;
	}


	var start = function() {
		var successor;
		var node;
		space.clearPath();

		var path = space.moveFromTo(null,initialAgent.state, goalAgent.state);
		var i = path.length-2;

		var timer = window.setInterval(function(){
			node = path[i];
			space.drawRec(space.createId('sol', node.state.x, node.state.y), node.state.x, node.state.y, '#ffcc00', 'solution');

			var j = 0;
			var timer2 = window.setInterval(function(node){
				successor = node.successors[j];
				if (!initialAgent.state.equalsTo(successor.state) && !goalAgent.state.equalsTo(successor.state))
					space.drawRec(space.createId('sol', successor.state.x, successor.state.y), successor.state.x, successor.state.y, '#23d400', 'solution');

				if (j === node.successors.length-1) {
					clearInterval(timer2);
				}

				j++;

			}, 5, node);


			if (i === 1) {
				clearInterval(timer);
			}

			i--;

		}, 100);


	};

</script>
</body>
</html>